
{% load static %}
<div class="chat-wrapper">
    <div class="chat-box" id="chatBox">
        <div class="chat-header">
            <div class="toggle-icon">ğŸ’¬</div>
            <span class="chat-title">Trá»£ lÃ½ ThuÃª Xe</span>
        </div>
        <div class="chat-body" id="chatBody">
            <div class="message bot-message">
                ChÃ o báº¡n! TÃ´i cÃ³ thá»ƒ giÃºp gÃ¬ cho báº¡n vá» dá»‹ch vá»¥ thuÃª xe?
            </div>
        </div>
        <div class="chat-footer">
            <div class="input-group">
                <input type="text" id="messageInput" placeholder="Nháº­p cÃ¢u há»i...">
                <button id="sendButton" onclick="sendMessage()">Gá»­i</button>
            </div>
        </div>
    </div>
    <div class="chat-toggle" onclick="toggleChat()">
        <div class="toggle-icon">ğŸš²</div>
    </div>
</div>
<script>
    let isOpen = false;
    const chatBox = document.getElementById('chatBox');
    const chatBody = document.getElementById('chatBody');
    const messageInput = document.getElementById('messageInput');

    function toggleChat() {
        isOpen = !isOpen;
        chatBox.classList.toggle('active');
        
        // Tá»± Ä‘á»™ng focus vÃ o Ã´ nháº­p khi má»Ÿ chat
        if(isOpen) {
            setTimeout(() => {
                messageInput.focus();
            }, 300);
        }
    }

    function sendMessage() {
        const message = messageInput.value.trim();
        if(!message) return;

        // ThÃªm tin nháº¯n ngÆ°á»i dÃ¹ng
        addMessage(message, 'user');
        
        // Giáº£ láº­p pháº£n há»“i bot
        setTimeout(() => {
            addMessage(getBotResponse(message), 'bot');
        }, 800);

        messageInput.value = '';
    }

    function addMessage(text, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${sender}-message`;
        messageDiv.textContent = text;
        
        chatBody.appendChild(messageDiv);
        chatBody.scrollTop = chatBody.scrollHeight;
    }

    function getBotResponse(message) {
        const responses = {
            'giÃ¡': 'GiÃ¡ thuÃª xe tá»« 20.000Ä‘ - 50.000Ä‘/giá» tÃ¹y loáº¡i xe',
            'Ä‘áº·t xe': 'Vui lÃ²ng truy cáº­p trang Äáº·t Xe Ä‘á»ƒ chá»n xe vÃ  thá»i gian',
            'má»Ÿ cá»­a': 'Cá»­a hÃ ng má»Ÿ cá»­a tá»« 7h - 22h hÃ ng ngÃ y',
            'fuc lÃ  ai': 'Fuc lÃ  1 tháº±ng lang bÄƒm há»c táº¡i TDT',
            'default': 'Xin lá»—i, tÃ´i chÆ°a hiá»ƒu. Vui lÃ²ng gá»i 1800 9473'
        };
        
        const lowerMsg = message.toLowerCase();
        return Object.keys(responses).find(key => lowerMsg.includes(key)) 
               ? responses[Object.keys(responses).find(key => lowerMsg.includes(key))] 
               : responses.default;
    }

    // Xá»­ lÃ½ sá»± kiá»‡n Enter
    messageInput.addEventListener('keypress', (e) => {
        if(e.key === 'Enter') sendMessage();
    });
</script>